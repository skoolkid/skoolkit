
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>ASM modes and directives &#8212; SkoolKit 9.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ASM templates" href="asm-templates.html" />
    <link rel="prev" title="Ref files" href="ref-files.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="asm-templates.html" title="ASM templates"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ref-files.html" title="Ref files"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SkoolKit 9.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ASM modes and directives</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="asm-modes-and-directives">
<span id="asmmodesanddirectives"></span><h1>ASM modes and directives<a class="headerlink" href="#asm-modes-and-directives" title="Permalink to this heading">¶</a></h1>
<p>A skool file may contain directives that are processed during the parsing
phase. Exactly how a directive is processed (and whether it is executed)
depends on the ‘substitution mode’ and ‘bugfix mode’ in which the skool file is
being parsed.</p>
<section id="substitution-modes">
<span id="substitutionmodes"></span><h2>Substitution modes<a class="headerlink" href="#substitution-modes" title="Permalink to this heading">¶</a></h2>
<p>There are three substitution modes: <code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code>, and <code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code>. These
modes are described in the following subsections.</p>
<section id="isub-mode">
<span id="isubmode"></span><h3>&#64;isub mode<a class="headerlink" href="#isub-mode" title="Permalink to this heading">¶</a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code> mode, <code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code> directives are executed, but <code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code>, and
<code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> directives are not. The main purpose of <code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code> mode is to make the
minimum number of instruction substitutions necessary to produce an ASM file
that assembles.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@isub=LD A,(32512)
 25396 LD A,(m)
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code> directive ensures that <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">A,(m)</span></code> is replaced by the valid
instruction <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">A,(32512)</span></code> when rendering in ASM mode.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code> mode is invoked by default when running
<a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a>.</p>
</section>
<section id="ssub-mode">
<span id="ssubmode"></span><h3>&#64;ssub mode<a class="headerlink" href="#ssub-mode" title="Permalink to this heading">¶</a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code> mode, <code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code> directives are executed, but
<code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> directives are not. The main purpose of <code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code> mode is to replace
LSBs, MSBs and full addresses in the operands of instructions with labels, to
make the code amenable to some degree of relocation, but without actually
removing or inserting any code.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@ssub=LD (27015+1),A
*27012 LD (27016),A  ; Change the instruction below from SET 0,B to RES 0,B
                     ; or vice versa
 27015 SET 0,B
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code> directive replaces <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(27016),A</span></code> with <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(27015+1),A</span></code>; the
<code class="docutils literal notranslate"><span class="pre">27015</span></code> will be replaced by the label for that address before rendering.
(<code class="docutils literal notranslate"><span class="pre">27016</span></code> cannot be replaced by a label, since it is not the address of an
instruction.)</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code> mode is invoked by passing the <code class="docutils literal notranslate"><span class="pre">-s</span></code> option to
<a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a>.</p>
</section>
<section id="rsub-mode">
<span id="rsubmode"></span><h3>&#64;rsub mode<a class="headerlink" href="#rsub-mode" title="Permalink to this heading">¶</a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> mode, <code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> directives are executed.
The main purpose of <code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> mode is to make code unconditionally relocatable,
even if that requires the removal of existing code or the insertion of new
code.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 23997 LD HL,32766
@ssub=LD (HL),24002%256
 24000 LD (HL),194
@rsub+begin
       INC L
       LD (HL),24002/256
@rsub+end
 24002 XOR A
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> block directive inserts two instructions that ensure that the
address stored at 32766 will have the correct MSB as well as the correct LSB,
regardless of where the code originally at 24002 now lives.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> mode is invoked by passing the <code class="docutils literal notranslate"><span class="pre">-r</span></code> option to
<a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a>. <code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> mode also implies
<a class="reference internal" href="#ofixmode"><span class="std std-ref">&#64;ofix mode</span></a>.</p>
</section>
</section>
<section id="bugfix-modes">
<span id="bugfixmodes"></span><h2>Bugfix modes<a class="headerlink" href="#bugfix-modes" title="Permalink to this heading">¶</a></h2>
<p>There are three bugfix modes: <code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code>. These
modes are described in the following subsections.</p>
<section id="ofix-mode">
<span id="ofixmode"></span><h3>&#64;ofix mode<a class="headerlink" href="#ofix-mode" title="Permalink to this heading">¶</a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code> mode, <code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code> directives are executed, but <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> and
<code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> directives are not. The main purpose of <code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code> mode is to fix
instructions that have faulty operands.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@ofix-begin
 27872 CALL 27633    ; This should be CALL 27634
@ofix+else
       CALL 27634
@ofix+end
</pre></div>
</div>
<p>These <code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code> block directives fix the faulty operand of the CALL
instruction.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code> mode is invoked by passing the <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">1</span></code> option to
<a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a>.</p>
</section>
<section id="bfix-mode">
<span id="bfixmode"></span><h3>&#64;bfix mode<a class="headerlink" href="#bfix-mode" title="Permalink to this heading">¶</a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> mode, <code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> directives are executed, but
<code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> directives are not. The main purpose of <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> mode is to fix bugs
by replacing instructions, but without changing the start address of any
routines, routine entry points, or data blocks.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix-begin
 32205 JR Z,32232    ; This should be JR NZ,32232
@bfix+else
       JR NZ,32232   ;
@bfix+end
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> mode is invoked by passing the <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">2</span></code> option to
<a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a>.</p>
</section>
<section id="rfix-mode">
<span id="rfixmode"></span><h3>&#64;rfix mode<a class="headerlink" href="#rfix-mode" title="Permalink to this heading">¶</a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> mode, <code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> directives are executed.
The purpose of <code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> mode is to fix bugs that cannot be fixed without
moving code around (to make space for the fix).</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 28432 DEC HL
@rfix+begin
       LD A,H
       OR L
@rfix+end
 28433 JP Z,29712
</pre></div>
</div>
<p>These <code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> block directives insert some instructions to fix the faulty
check on whether HL holds 0.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> mode is invoked by passing the <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">3</span></code> option to
<a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a>. <code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> mode implies <a class="reference internal" href="#rsubmode"><span class="std std-ref">&#64;rsub mode</span></a>.</p>
</section>
</section>
<section id="asm-directives">
<span id="asmdirectives"></span><h2>ASM directives<a class="headerlink" href="#asm-directives" title="Permalink to this heading">¶</a></h2>
<p>The ASM directives recognised by SkoolKit are described in the following
subsections.</p>
<section id="assemble">
<span id="id1"></span><h3>&#64;assemble<a class="headerlink" href="#assemble" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;assemble</span></code> directive controls whether assembly language instructions,
<code class="docutils literal notranslate"><span class="pre">DEFB</span></code>, <code class="docutils literal notranslate"><span class="pre">DEFM</span></code>, <code class="docutils literal notranslate"><span class="pre">DEFS</span></code> and <code class="docutils literal notranslate"><span class="pre">DEFW</span></code> statements, and <a class="reference internal" href="#defb"><span class="std std-ref">&#64;defb</span></a>,
<a class="reference internal" href="#defs"><span class="std std-ref">&#64;defs</span></a> and <a class="reference internal" href="#defw"><span class="std std-ref">&#64;defw</span></a> directives are converted into byte values for the
purpose of populating the memory snapshot.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@assemble=H,A
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">H</span></code> is an integer value that determines what is converted in HTML mode, and
<code class="docutils literal notranslate"><span class="pre">A</span></code> is an integer value that determines what is converted in ASM mode:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> - do not convert anything</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - convert <code class="docutils literal notranslate"><span class="pre">DEFB</span></code>, <code class="docutils literal notranslate"><span class="pre">DEFM</span></code>, <code class="docutils literal notranslate"><span class="pre">DEFS</span></code> and <code class="docutils literal notranslate"><span class="pre">DEFW</span></code> statements and
<code class="docutils literal notranslate"><span class="pre">&#64;defb</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;defs</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;defw</span></code> directives only</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> - convert assembly language instructions as well (this is the default
in both HTML and ASM mode)</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">H</span></code> or <code class="docutils literal notranslate"><span class="pre">A</span></code> is blank or omitted, its value is left unchanged.</p>
<p>Note that setting <code class="docutils literal notranslate"><span class="pre">H</span></code> or <code class="docutils literal notranslate"><span class="pre">A</span></code> to something other than the default value of 2
may affect the output of skool macros that inspect or operate on the contents
of the memory snapshot:</p>
<ul class="simple">
<li><p><a class="reference internal" href="skool-macros.html#audio"><span class="std std-ref">#AUDIO</span></a></p></li>
<li><p><a class="reference internal" href="skool-macros.html#font"><span class="std std-ref">#FONT</span></a></p></li>
<li><p><a class="reference internal" href="skool-macros.html#peek"><span class="std std-ref">#PEEK</span></a></p></li>
<li><p><a class="reference internal" href="skool-macros.html#scr"><span class="std std-ref">#SCR</span></a></p></li>
<li><p><a class="reference internal" href="skool-macros.html#sim"><span class="std std-ref">#SIM</span></a></p></li>
<li><p><a class="reference internal" href="skool-macros.html#str"><span class="std std-ref">#STR</span></a></p></li>
<li><p><a class="reference internal" href="skool-macros.html#tstates"><span class="std std-ref">#TSTATES</span></a></p></li>
<li><p><a class="reference internal" href="skool-macros.html#udg"><span class="std std-ref">#UDG</span></a></p></li>
<li><p><a class="reference internal" href="skool-macros.html#udgarray"><span class="std std-ref">#UDGARRAY</span></a></p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>9.0</p></td>
<td><p>The default value of both <code class="docutils literal notranslate"><span class="pre">H</span></code> and <code class="docutils literal notranslate"><span class="pre">A</span></code> is 2 (previously 1 and
0)</p></td>
</tr>
<tr class="row-odd"><td><p>7.0</p></td>
<td><p>The accepted values are 0, 1 and 2 (previously -1, 0 and 1)</p></td>
</tr>
<tr class="row-even"><td><p>6.3</p></td>
<td><p>Added support for specifying what’s converted in HTML mode and
ASM mode separately, and for switching off conversion entirely</p></td>
</tr>
<tr class="row-odd"><td><p>6.1</p></td>
<td><p>Added the ability to assemble instructions whose operands contain
arithmetic expressions</p></td>
</tr>
<tr class="row-even"><td><p>5.0</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="bank">
<span id="asm-bank"></span><h3>&#64;bank<a class="headerlink" href="#bank" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;bank</span></code> directive either specifies the RAM bank that is mapped to
49152-65535 (0xC000-0xFFFF) in the memory snapshot:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bank=page
</pre></div>
</div>
<p>or populates a specific RAM bank in the memory snapshot from the contents of
another skool file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bank=page,fname
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">page</span></code> is the page number (0-7)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fname</span></code> is the name of the skool file</p></li>
</ul>
<p>When the first <code class="docutils literal notranslate"><span class="pre">&#64;bank</span></code> directive in a skool file is processed, the memory
snapshot is converted from 48K to 128K and the 128K ROM is loaded.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>9.1</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="bfix">
<span id="id2"></span><h3>&#64;bfix<a class="headerlink" href="#bfix" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> directive replaces, inserts or removes a label, instruction and
comment in <a class="reference internal" href="#bfixmode"><span class="std std-ref">&#64;bfix mode</span></a>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=[&gt;][|][+][/][LABEL:][INSTRUCTION][; comment]
</pre></div>
</div>
<p>or, when removing instructions:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=!addr1[-addr2]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code> - if this marker is present, <code class="docutils literal notranslate"><span class="pre">INSTRUCTION</span></code> is inserted before the
current instruction instead of replacing it</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">|</span></code> - if this marker is present, <code class="docutils literal notranslate"><span class="pre">INSTRUCTION</span></code> overwrites any overlapping
instructions instead of pushing them aside</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+</span></code> - if this marker is present, <code class="docutils literal notranslate"><span class="pre">INSTRUCTION</span></code> is inserted after the
current instruction instead of replacing it</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/</span></code> - if this marker is present, any remaining comment lines are removed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LABEL</span></code> is the replacement label; if not given, any existing label is left
unchanged</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INSTRUCTION</span></code> is the replacement instruction; if not given, the existing
instruction is left unchanged</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comment</span></code> is the replacement comment; if not given, the existing comment is
left unchanged</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">addr1</span></code> is the address of the first instruction to remove</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">addr2</span></code>, if given, is the address of the last instruction to remove</p></li>
</ul>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@label=CMASK
@bfix=BMASK: AND B ; Apply the mask
 29713 AND C       ; This should be &#39;AND B&#39;
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> directive replaces the instruction <code class="docutils literal notranslate"><span class="pre">AND</span> <span class="pre">C</span></code> with <code class="docutils literal notranslate"><span class="pre">AND</span> <span class="pre">B</span></code>,
replaces the label <code class="docutils literal notranslate"><span class="pre">CMASK</span></code> with <code class="docutils literal notranslate"><span class="pre">BMASK</span></code>, and also replaces the comment.</p>
<p>Comment continuation lines can be replaced, removed or added by using
additional <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> directives. For example, to replace both comment lines
of an instruction that has two:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=AND B  ; This directive replaces the first comment line
@bfix=       ; and this directive replaces the second comment line
 29713 AND C ; Both of these comment lines
             ; will be replaced
</pre></div>
</div>
<p>To add a second comment line to an instruction that has only one:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=AND B  ; This directive replaces the first comment line
@bfix=       ; and this directive adds a second comment line
 29713 AND C ; This comment line will be replaced
</pre></div>
</div>
<p>To replace two comment lines with one:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=/AND B ; The &#39;/&#39; in this directive effectively terminates the comment
 29713 AND C ; This comment line will be replaced
             ; and this one will be removed
</pre></div>
</div>
<p>A single instruction can be replaced with two or more by using the <code class="docutils literal notranslate"><span class="pre">|</span></code>
(overwrite) marker. For example, to replace <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">HL,0</span></code> with <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">L,0</span></code> and
<code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">H,L</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=|LD L,0  ; Clear L
@bfix=|LD H,L  ; Clear H
 36671 LD HL,0 ; Clear HL
</pre></div>
</div>
<p>Two or more instructions can also be replaced with a single instruction. For
example, to replace <code class="docutils literal notranslate"><span class="pre">XOR</span> <span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">INC</span> <span class="pre">A</span></code> with <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">A,1</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=|LD A,1
 49912 XOR A
 49913 INC A
</pre></div>
</div>
<p>A sequence of instructions can be replaced by chaining <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> directives.
For example, to swap two <code class="docutils literal notranslate"><span class="pre">XOR</span></code> instructions:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=|XOR C
@bfix=|XOR B
 51121 XOR B
 51122 XOR C
</pre></div>
</div>
<p>This is equivalent to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=XOR C
 51121 XOR B
@bfix=XOR B
 51122 XOR C
</pre></div>
</div>
<p>Note that when <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> directives are chained like this, the second and
subsequent directives replace instruction comments in their entirety, instead
of line by line. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=|LD A,D ; Set A=D
@bfix=|XOR B  ; Flip the bits
 51121 LD A,B ; Set A=B
 51122 XOR C  ; XOR the contents of the accumulator with the contents of the
              ; C register
</pre></div>
</div>
<p>replaces both comment lines of the instruction at 51122 with ‘Flip the bits’.</p>
<p>A sequence of instructions can be inserted before the current instruction by
using the <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> marker. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 47191 EX DE,HL
; A mid-block comment.
@bfix=&gt;LD (HL),C
@bfix=&gt;INC HL
 47192 LD (HL),B
</pre></div>
</div>
<p>This will insert <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),C</span></code> and <code class="docutils literal notranslate"><span class="pre">INC</span> <span class="pre">HL</span></code> between <code class="docutils literal notranslate"><span class="pre">EX</span> <span class="pre">DE,HL</span></code> and
<code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),B</span></code>. The mid-block comment that was above <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),B</span></code> will now be
above <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),C</span></code>.</p>
<p>A sequence of instructions can be inserted after the current instruction
(without first specifying a replacement for it) by using the <code class="docutils literal notranslate"><span class="pre">+</span></code> marker. For
example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=+LD (HL),C
@bfix=INC HL
 47191 EX DE,HL
; A mid-block comment.
 47192 LD (HL),B
</pre></div>
</div>
<p>This will insert <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),C</span></code> and <code class="docutils literal notranslate"><span class="pre">INC</span> <span class="pre">HL</span></code> between <code class="docutils literal notranslate"><span class="pre">EX</span> <span class="pre">DE,HL</span></code> and
<code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),B</span></code>. In this case, the mid-block comment above <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),B</span></code> will
remain there.</p>
<p>The current instruction can be replaced and a sequence of instructions inserted
after it by chaining <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> directives. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix=LD (HL),B  ; {Save B and C here
@bfix=INC HL     ;
@bfix=LD (HL),C  ; }
 61125 LD (HL),A ; Save A here
 61126 RET
</pre></div>
</div>
<p>This will replace <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),A</span></code> with <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),B</span></code> and insert <code class="docutils literal notranslate"><span class="pre">INC</span> <span class="pre">HL</span></code> and
<code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">(HL),C</span></code> before the <code class="docutils literal notranslate"><span class="pre">RET</span></code> instruction.</p>
<p>An instruction can be removed by using the <code class="docutils literal notranslate"><span class="pre">!</span></code> notation. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 51184 XOR A
@bfix=!51185
 51185 AND A ; This instruction is redundant
 51186 RET
</pre></div>
</div>
<p>This removes the redundant instruction at 51185.</p>
<p>An entire entry can be removed by specifying an address range that covers every
instruction in the entry:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>; Unused
@bfix=!40000-40001
c40000 NOP
 40001 RET
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7.1</p></td>
<td><p>Added support for the <code class="docutils literal notranslate"><span class="pre">+</span></code> marker (to insert an instruction
after the current one)</p></td>
</tr>
<tr class="row-odd"><td><p>7.0</p></td>
<td><p>Added support for specifying the replacement comment over
multiple lines, replacing the label, and inserting, overwriting
and removing instructions</p></td>
</tr>
<tr class="row-even"><td><p>6.4</p></td>
<td><p>Added support for replacing the comment</p></td>
</tr>
</tbody>
</table>
</section>
<section id="bfix-block-directives">
<span id="bfixblockdirectives"></span><h3>&#64;bfix block directives<a class="headerlink" href="#bfix-block-directives" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> block directives define a block of lines that will be inserted or
removed in <a class="reference internal" href="#bfixmode"><span class="std std-ref">&#64;bfix mode</span></a>.</p>
<p>The syntax for defining a block that will be inserted in <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> mode (but
left out otherwise) is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix+begin
...                  ; Lines to be inserted
@bfix+end
</pre></div>
</div>
<p>The syntax for defining a block that will be removed in <code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> mode (but
left in otherwise) is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix-begin
...                  ; Lines to be removed
@bfix-end
</pre></div>
</div>
<p>Typically, though, it is desirable to define a block that will be removed in
<code class="docutils literal notranslate"><span class="pre">&#64;bfix</span></code> mode right next to the block that will be inserted in its place. That
may be done thus:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix-begin
...                  ; Instructions to be removed
@bfix+else
...                  ; Instructions to be inserted
@bfix+end
</pre></div>
</div>
<p>which is equivalent to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix-begin
...                  ; Instructions to be removed
@bfix-end
@bfix+begin
...                  ; Instructions to be inserted
@bfix+end
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@bfix-begin
 32205 JR Z,32232    ; This should be JR NZ,32232
@bfix+else
       JR NZ,32232   ;
@bfix+end
</pre></div>
</div>
</section>
<section id="defb">
<span id="id3"></span><h3>&#64;defb<a class="headerlink" href="#defb" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;defb</span></code> directive makes <a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a> and <a class="reference internal" href="commands.html#skool2html-py"><span class="std std-ref">skool2html.py</span></a>
insert byte values into the memory snapshot at a given address.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@defb=[address:]value1[,value2...]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code> is the address</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value1</span></code>, <code class="docutils literal notranslate"><span class="pre">value2</span></code> etc. are the byte values (as might appear in a
<code class="docutils literal notranslate"><span class="pre">DEFB</span></code> statement)</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">address</span></code> is omitted, it defaults to the address immediately after the
last byte of the previous <code class="docutils literal notranslate"><span class="pre">&#64;defb</span></code>, <a class="reference internal" href="#defs"><span class="std std-ref">&#64;defs</span></a> or <a class="reference internal" href="#defw"><span class="std std-ref">&#64;defw</span></a> directive
preceding the same instruction (if one exists), or to the address of the next
instruction otherwise.</p>
<p>The sequence of comma-separated values may be followed by a semicolon (<code class="docutils literal notranslate"><span class="pre">;</span></code>)
and arbitrary text, which will be ignored.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@defb=30000:5,&quot;Hello&quot; ; Welcome message
</pre></div>
</div>
<p>This will insert the value 5 followed by the ASCII codes of the characters in
“Hello” into the memory snapshot at address 30000.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;defb</span></code> directives are also processed by <a class="reference internal" href="commands.html#sna2skool-py"><span class="std std-ref">sna2skool.py</span></a> when it is run
on a control file; thus the <code class="docutils literal notranslate"><span class="pre">&#64;defb</span></code> directive can be used to override the
contents of the snapshot that is read by <cite>sna2skool.py</cite>.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;defb</span></code> directives are also processed by <a class="reference internal" href="commands.html#skool2bin-py"><span class="std std-ref">skool2bin.py</span></a> when the
<code class="docutils literal notranslate"><span class="pre">--data</span></code> option is used.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.1</p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">address</span></code> parameter is optional</p></td>
</tr>
<tr class="row-odd"><td><p>6.3</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="defs">
<span id="id4"></span><h3>&#64;defs<a class="headerlink" href="#defs" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;defs</span></code> directive makes <a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a> and <a class="reference internal" href="commands.html#skool2html-py"><span class="std std-ref">skool2html.py</span></a>
insert a sequence of byte values into the memory snapshot at a given address.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@defs=[address:]length[,value]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code> is the address</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code> is the length of the sequence</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code> is the byte value (default: 0)</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">address</span></code> is omitted, it defaults to the address immediately after the
last byte of the previous <a class="reference internal" href="#defb"><span class="std std-ref">&#64;defb</span></a>, <code class="docutils literal notranslate"><span class="pre">&#64;defs</span></code> or <a class="reference internal" href="#defw"><span class="std std-ref">&#64;defw</span></a> directive
preceding the same instruction (if one exists), or to the address of the next
instruction otherwise.</p>
<p>The directive may be followed by a semicolon (<code class="docutils literal notranslate"><span class="pre">;</span></code>) and arbitrary text, which
will be ignored.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@defs=30000:5,$FF ; Five 255s
</pre></div>
</div>
<p>This will insert the value 255 into the memory snapshot at addresses
30000-30004.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;defs</span></code> directives are also processed by <a class="reference internal" href="commands.html#sna2skool-py"><span class="std std-ref">sna2skool.py</span></a> when it is run
on a control file; thus the <code class="docutils literal notranslate"><span class="pre">&#64;defs</span></code> directive can be used to override the
contents of the snapshot that is read by <cite>sna2skool.py</cite>.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;defs</span></code> directives are also processed by <a class="reference internal" href="commands.html#skool2bin-py"><span class="std std-ref">skool2bin.py</span></a> when the
<code class="docutils literal notranslate"><span class="pre">--data</span></code> option is used.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.1</p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">address</span></code> parameter is optional</p></td>
</tr>
<tr class="row-odd"><td><p>6.3</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="defw">
<span id="id5"></span><h3>&#64;defw<a class="headerlink" href="#defw" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;defw</span></code> directive makes <a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a> and <a class="reference internal" href="commands.html#skool2html-py"><span class="std std-ref">skool2html.py</span></a>
insert word values into the memory snapshot at a given address.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@defw=[address:]value1[,value2...]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code> is the address</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value1</span></code>, <code class="docutils literal notranslate"><span class="pre">value2</span></code> etc. are the word values (as might appear in a
<code class="docutils literal notranslate"><span class="pre">DEFW</span></code> statement)</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">address</span></code> is omitted, it defaults to the address immediately after the
last byte of the previous <a class="reference internal" href="#defb"><span class="std std-ref">&#64;defb</span></a>, <a class="reference internal" href="#defs"><span class="std std-ref">&#64;defs</span></a> or <code class="docutils literal notranslate"><span class="pre">&#64;defw</span></code> directive
preceding the same instruction (if one exists), or to the address of the next
instruction otherwise.</p>
<p>The sequence of comma-separated values may be followed by a semicolon (<code class="docutils literal notranslate"><span class="pre">;</span></code>)
and arbitrary text, which will be ignored.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@defw=30000:32768,32775 ; Message addresses
</pre></div>
</div>
<p>This will insert the word values 32768 and 32775 into the memory snapshot at
addresses 30000 and 30002.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;defw</span></code> directives are also processed by <a class="reference internal" href="commands.html#sna2skool-py"><span class="std std-ref">sna2skool.py</span></a> when it is run
on a control file; thus the <code class="docutils literal notranslate"><span class="pre">&#64;defw</span></code> directive can be used to override the
contents of the snapshot that is read by <cite>sna2skool.py</cite>.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;defw</span></code> directives are also processed by <a class="reference internal" href="commands.html#skool2bin-py"><span class="std std-ref">skool2bin.py</span></a> when the
<code class="docutils literal notranslate"><span class="pre">--data</span></code> option is used.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.1</p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">address</span></code> parameter is optional</p></td>
</tr>
<tr class="row-odd"><td><p>6.3</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="end">
<span id="id6"></span><h3>&#64;end<a class="headerlink" href="#end" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;end</span></code> directive may be used to indicate where to stop parsing the skool
file for the purpose of generating ASM output. Everything after the <code class="docutils literal notranslate"><span class="pre">&#64;end</span></code>
directive is ignored by <a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a>.</p>
<p>See also <a class="reference internal" href="#start"><span class="std std-ref">&#64;start</span></a>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2.2.2</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="equ">
<span id="id7"></span><h3>&#64;equ<a class="headerlink" href="#equ" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;equ</span></code> directive defines an EQU directive that will appear in the ASM
output.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@equ=label=value
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code> is the label</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code> is the value assigned to the label</p></li>
</ul>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@equ=ATTRS=22528
c32768 LD HL,22528
</pre></div>
</div>
<p>This will produce an EQU directive (<code class="docutils literal notranslate"><span class="pre">ATTRS</span> <span class="pre">EQU</span> <span class="pre">22528</span></code>) in the ASM output, and
replace the operand of the instruction at 32768 with a label: <code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">HL,ATTRS</span></code>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>5.4</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="expand">
<span id="id8"></span><h3>&#64;expand<a class="headerlink" href="#expand" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;expand</span></code> directive specifies an arbitrary piece of text - intended to
consist of one or more <a class="reference internal" href="skool-macros.html#smplmacros"><span class="std std-ref">SMPL macros</span></a> - that will be expanded by the ASM
writer or HTML writer during initialisation (before any skool macros that
appear in skool file annotations or ref file sections are expanded).</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@expand=text
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">text</span></code> is the text to expand</p></li>
</ul>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@expand=#DEF(#MAX(a,b) #IF($a&gt;$b)($a,$b))
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;expand</span></code> directive passes the given <a class="reference internal" href="skool-macros.html#def"><span class="std std-ref">#DEF</span></a> macro to the ASM writer
or HTML writer for expansion during initialisation; this has the effect of
making the user-defined <code class="docutils literal notranslate"><span class="pre">#MAX</span></code> macro available for use immediately anywhere
in the skool file (and any secondary skool files if the directive appears in
the main skool file) or ref files.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">text</span></code> begins with <code class="docutils literal notranslate"><span class="pre">+</span></code>, it is appended to the text of the previous
<code class="docutils literal notranslate"><span class="pre">&#64;expand</span></code> directive (with the <code class="docutils literal notranslate"><span class="pre">+</span></code> removed); this enables long macro
definitions to be split over multiple lines. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@expand=#DEF(#OLIST()(items)
@expand=+  #LET(n=1)
@expand=+  #LIST
@expand=+  #FOREACH($items)(item,{ #EVAL({n}). item } #LET(n={n}+1))
@expand=+  LIST#
@expand=+)
</pre></div>
</div>
<p>These <code class="docutils literal notranslate"><span class="pre">&#64;expand</span></code> directives make the <code class="docutils literal notranslate"><span class="pre">#OLIST</span></code> macro available, which can
then be used to create a numbered list of items:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#OLIST/a,b,c/
</pre></div>
</div>
<p>See also the <code class="docutils literal notranslate"><span class="pre">Expand</span></code> parameter in the <a class="reference internal" href="ref-files.html#ref-config"><span class="std std-ref">[Config]</span></a> section, which may
be used instead of the <code class="docutils literal notranslate"><span class="pre">&#64;expand</span></code> directive if there is no need to expand
<code class="docutils literal notranslate"><span class="pre">text</span></code> in ASM mode.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.4</p></td>
<td><p>Added support for the <code class="docutils literal notranslate"><span class="pre">+</span></code> notation</p></td>
</tr>
<tr class="row-odd"><td><p>8.2</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="if">
<span id="asm-if"></span><h3>&#64;if<a class="headerlink" href="#if" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;if</span></code> directive conditionally processes other ASM directives based on the
value of an arithmetic expression.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@if(expr)(true[,false])
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">expr</span></code> is the arithmetic expression, which may contain
<a class="reference internal" href="skool-macros.html#replacementfields"><span class="std std-ref">replacement fields</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">true</span></code> is processed when <code class="docutils literal notranslate"><span class="pre">expr</span></code> is true</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">false</span></code> (if given) is processed when <code class="docutils literal notranslate"><span class="pre">expr</span></code> is false</p></li>
</ul>
<p>See <a class="reference internal" href="skool-macros.html#numericparameters"><span class="std std-ref">Numeric parameters</span></a> for details on the operators that may be used in
the <code class="docutils literal notranslate"><span class="pre">expr</span></code> parameter.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@if({mode[case]}==1))(replace=/#hl/hl,replace=/#hl/HL)
</pre></div>
</div>
<p>would process <code class="docutils literal notranslate"><span class="pre">replace=/#hl/hl</span></code> if in lower case mode, or <code class="docutils literal notranslate"><span class="pre">replace=/#hl/HL</span></code>
otherwise.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">false</span></code> parameters may be supplied in the same way as they
are for the <a class="reference internal" href="skool-macros.html#if"><span class="std std-ref">#IF</span></a> macro. See <a class="reference internal" href="skool-macros.html#stringparameters"><span class="std std-ref">String parameters</span></a> for more details.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>6.4</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ignoreua">
<span id="id9"></span><h3>&#64;ignoreua<a class="headerlink" href="#ignoreua" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;ignoreua</span></code> directive suppresses warnings that would otherwise be printed
(during the rendering phase) concerning addresses not converted to labels in
the comment that follows. The comment may be an entry title, an entry
description, a register description section, a block start comment, a mid-block
comment, a block end comment, or an instruction-level comment.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@ignoreua[=addr1[,addr2...]]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">addr1</span></code>, <code class="docutils literal notranslate"><span class="pre">addr2</span></code> etc. are the addresses to suppress warnings for; if none
are specified, warnings for all addresses are suppressed</p></li>
</ul>
<p>Although specifying a list of addresses is optional, doing so has the advantage
that if another unconvertible address is added to the comment later on, a
warning will appear for it, at which point you can decide whether to fix it (in
case it was added by mistake) or add it to the list.</p>
<p>To apply the directive to an entry title:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@ignoreua=32768
; Prepare data at 32768
c32768 LD A,(HL)
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">&#64;ignoreua</span></code> directive were not present, a warning would be printed
about the entry title containing an address (32768) that has not been converted
to a label.</p>
<p>To apply the directive to an entry description:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>; Prepare data in page 128
;
@ignoreua
; This routine operates on the data at 32768.
c49152 LD A,(HL)
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">&#64;ignoreua</span></code> directive were not present, a warning would be printed
about the entry description containing an address (32768) that has not been
converted to a label.</p>
<p>To apply the directive to a register description section:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>; Prepare data in page 128
;
; This routine operates on the data in page 128.
;
@ignoreua
; HL 32768
c49152 LD A,(HL)
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">&#64;ignoreua</span></code> directive were not present, a warning would be printed
about the register description containing an address (32768) that has not been
converted to a label.</p>
<p>To apply the directive to a block start comment:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>; Prepare data in page 128
;
; This routine operates on the data in page 128.
;
; HL 128*256
;
@ignoreua
; First pick up the byte at 32768.
c49152 LD A,(HL)
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">&#64;ignoreua</span></code> directive were not present, a warning would be printed
about the start comment containing an address (32768) that has not been
converted to a label.</p>
<p>To apply the directive to a mid-block comment:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 28913 LD L,A
@ignoreua
; #REGhl now holds either 32522 or 32600.
 28914 LD B,(HL)
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">&#64;ignoreua</span></code> directive were not present, a warning would be printed
about the comment containing addresses (32522, 32600) that have not been
converted to labels.</p>
<p>To apply the directive to a block end comment:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 44159 JP 63152
@ignoreua
; This routine continues at 63152.
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">&#64;ignoreua</span></code> directive were not present, a warning would be printed
about the comment containing an address (63152) that has not been converted to
a label.</p>
<p>To apply the directive to an instruction-level comment:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@ignoreua
 60159 LD C,A        ; #REGbc now holds 62818
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">&#64;ignoreua</span></code> directive were not present, a warning would be printed
about the comment containing an address (62818) that has not been converted to
a label.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.1</p></td>
<td><p>Added the ability to specify the addresses for which to suppress
warnings</p></td>
</tr>
<tr class="row-odd"><td><p>4.2</p></td>
<td><p>Added support for register description sections</p></td>
</tr>
<tr class="row-even"><td><p>2.4.1</p></td>
<td><p>Added support for entry titles, entry descriptions, mid-block
comments and block end comments</p></td>
</tr>
</tbody>
</table>
</section>
<section id="isub">
<span id="id10"></span><h3>&#64;isub<a class="headerlink" href="#isub" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code> directive replaces, inserts or removes a label, instruction and
comment in <a class="reference internal" href="#isubmode"><span class="std std-ref">&#64;isub mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#bfix"><span class="std std-ref">&#64;bfix</span></a> directive.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7.1</p></td>
<td><p>Added support for the <code class="docutils literal notranslate"><span class="pre">+</span></code> marker (to insert an instruction
after the current one)</p></td>
</tr>
<tr class="row-odd"><td><p>7.0</p></td>
<td><p>Added support for specifying the replacement comment over
multiple lines, replacing the label, and inserting, overwriting
and removing instructions</p></td>
</tr>
<tr class="row-even"><td><p>6.4</p></td>
<td><p>Added support for replacing the comment</p></td>
</tr>
</tbody>
</table>
</section>
<section id="isub-block-directives">
<span id="isubblockdirectives"></span><h3>&#64;isub block directives<a class="headerlink" href="#isub-block-directives" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;isub</span></code> block directives define a block of lines that will be inserted or
removed in <a class="reference internal" href="#isubmode"><span class="std std-ref">&#64;isub mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#bfixblockdirectives"><span class="std std-ref">&#64;bfix block directives</span></a>.</p>
</section>
<section id="keep">
<span id="id11"></span><h3>&#64;keep<a class="headerlink" href="#keep" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;keep</span></code> directive prevents the substitution of labels for numeric values
in the operand of the next instruction:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@keep[=val1[,val2...]]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">val1</span></code>, <code class="docutils literal notranslate"><span class="pre">val2</span></code> etc. are the values to keep; if none are specified, all
values are kept</p></li>
</ul>
<p>In HTML mode, the <code class="docutils literal notranslate"><span class="pre">&#64;keep</span></code> directive also prevents the operand from being
hyperlinked.</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@keep
 28328 LD BC,24576   ; #REGb=96, #REGc=0
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">&#64;keep</span></code> directive were not present, the operand (24576) of the
<code class="docutils literal notranslate"><span class="pre">LD</span> <span class="pre">BC</span></code> instruction would be replaced with the label of the routine at 24576
(if there is a routine at that address); however, the operand is meant to be a
pure data value, not a variable or routine address.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>6.2</p></td>
<td><p>Added the ability to specify the values to keep; the <code class="docutils literal notranslate"><span class="pre">&#64;keep</span></code>
directive is applied to instructions that have been replaced by
an <a class="reference internal" href="#isub"><span class="std std-ref">&#64;isub</span></a>, <a class="reference internal" href="#ssub"><span class="std std-ref">&#64;ssub</span></a> or <a class="reference internal" href="#rsub"><span class="std std-ref">&#64;rsub</span></a> directive</p></td>
</tr>
</tbody>
</table>
</section>
<section id="label">
<span id="id12"></span><h3>&#64;label<a class="headerlink" href="#label" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;label</span></code> directive sets the label for the next instruction.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@label=LABEL
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LABEL</span></code> is the label to apply</p></li>
</ul>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@label=ENDGAME
c24576 XOR A
</pre></div>
</div>
<p>This sets the label for the routine at 24576 to <code class="docutils literal notranslate"><span class="pre">ENDGAME</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">LABEL</span></code> is blank (<code class="docutils literal notranslate"><span class="pre">&#64;label=</span></code>), the next instruction will have its entry
point marker removed (if it has one), and be prevented from having a label
automatically generated.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">LABEL</span></code> starts with <code class="docutils literal notranslate"><span class="pre">*</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">&#64;label=*LOOP</span></code>), the next instruction
will be marked as an entry point (as if the instruction line in the skool file
started with <code class="docutils literal notranslate"><span class="pre">*</span></code>), in addition to having its label set.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">LABEL</span></code> is just <code class="docutils literal notranslate"><span class="pre">*</span></code> (<code class="docutils literal notranslate"><span class="pre">&#64;label=*</span></code>), the next instruction will be marked
as an entry point, and have a label automatically generated.</p>
<p><a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a> automatically uses labels defined by the <code class="docutils literal notranslate"><span class="pre">&#64;label</span></code>
directive. <a class="reference internal" href="commands.html#skool2html-py"><span class="std std-ref">skool2html.py</span></a> includes them in its output if the
<code class="docutils literal notranslate"><span class="pre">--asm-labels</span></code> option is used.</p>
<p><code class="docutils literal notranslate"><span class="pre">&#64;label</span></code> directive values are also checked by <a class="reference internal" href="commands.html#sna2skool-py"><span class="std std-ref">sna2skool.py</span></a> while
reading a control file. They can be used to prevent an entry point marker from
being added to an instruction where it otherwise would be (<code class="docutils literal notranslate"><span class="pre">&#64;label=</span></code>), or
force one to be added where it otherwise wouldn’t (<code class="docutils literal notranslate"><span class="pre">&#64;label=*</span></code>).</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7.0</p></td>
<td><p>An entry point marker (<code class="docutils literal notranslate"><span class="pre">*</span></code>) can be added to or removed from the
next instruction</p></td>
</tr>
<tr class="row-odd"><td><p>6.3</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">LABEL</span></code> may be blank (to prevent the next instruction from
having a label automatically generated)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="nowarn">
<span id="id13"></span><h3>&#64;nowarn<a class="headerlink" href="#nowarn" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;nowarn</span></code> directive suppresses any warnings that would otherwise be
reported (during the parsing phase) for the next instruction concerning:</p>
<ul class="simple">
<li><p>an address in a <code class="docutils literal notranslate"><span class="pre">LD</span></code> instruction operand being replaced with a label (if
the instruction has not been replaced by a <code class="docutils literal notranslate"><span class="pre">&#64;*sub</span></code> or <code class="docutils literal notranslate"><span class="pre">&#64;*fix</span></code> directive)</p></li>
<li><p>an address in an instruction operand not being replaced with a label (because
the address has no label defined)</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@nowarn[=addr1[,addr2...]]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">addr1</span></code>, <code class="docutils literal notranslate"><span class="pre">addr2</span></code> etc. are the addresses to suppress warnings for; if none
are specified, warnings for all addresses are suppressed</p></li>
</ul>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@nowarn=25404
 25560 LD BC,25404   ; Point #REGbc at the routine at #R25404
</pre></div>
</div>
<p>If this <code class="docutils literal notranslate"><span class="pre">&#64;nowarn</span></code> directive were not present, a warning would be printed
about the operand (25404) being replaced with a routine label (which would be
inappropriate if 25404 were intended to be a pure data value).</p>
<p>For another example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@ofix-begin
@nowarn
 27872 CALL 27633    ; This should be CALL #R27634
@ofix+else
       CALL 27634    ;
@ofix+end
</pre></div>
</div>
<p>If this <code class="docutils literal notranslate"><span class="pre">&#64;nowarn</span></code> directive were not present, a warning would be printed (if
not in <a class="reference internal" href="#ofixmode"><span class="std std-ref">&#64;ofix mode</span></a>) about the operand (27633) not being replaced with a
label (usually you would want the operand of a CALL instruction to be replaced
with a label, but not in this case).</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.1</p></td>
<td><p>Added the ability to specify the addresses for which to suppress
warnings</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ofix">
<span id="id14"></span><h3>&#64;ofix<a class="headerlink" href="#ofix" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code> directive replaces, inserts or removes a label, instruction and
comment in <a class="reference internal" href="#ofixmode"><span class="std std-ref">&#64;ofix mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#bfix"><span class="std std-ref">&#64;bfix</span></a> directive.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7.1</p></td>
<td><p>Added support for the <code class="docutils literal notranslate"><span class="pre">+</span></code> marker (to insert an instruction
after the current one)</p></td>
</tr>
<tr class="row-odd"><td><p>7.0</p></td>
<td><p>Added support for specifying the replacement comment over
multiple lines, replacing the label, and inserting, overwriting
and removing instructions</p></td>
</tr>
<tr class="row-even"><td><p>6.4</p></td>
<td><p>Added support for replacing the comment</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ofix-block-directives">
<span id="ofixblockdirectives"></span><h3>&#64;ofix block directives<a class="headerlink" href="#ofix-block-directives" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;ofix</span></code> block directives define a block of lines that will be inserted or
removed in <a class="reference internal" href="#ofixmode"><span class="std std-ref">&#64;ofix mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#bfixblockdirectives"><span class="std std-ref">&#64;bfix block directives</span></a>.</p>
</section>
<section id="org">
<span id="id15"></span><h3>&#64;org<a class="headerlink" href="#org" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;org</span></code> directive makes <a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a> insert an <code class="docutils literal notranslate"><span class="pre">ORG</span></code> assembler
directive.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@org[=address]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code> is the <code class="docutils literal notranslate"><span class="pre">ORG</span></code> address; if not specified, it defaults to the
address of the next instruction</p></li>
</ul>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">&#64;org</span></code> directive works only on the first instruction in an
entry.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;org</span></code> directive also forces <a class="reference internal" href="commands.html#skool2bin-py"><span class="std std-ref">skool2bin.py</span></a> to place the next
instruction at the given address.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>6.3</p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">address</span></code> parameter is optional</p></td>
</tr>
</tbody>
</table>
</section>
<section id="refs">
<span id="id16"></span><h3>&#64;refs<a class="headerlink" href="#refs" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;refs</span></code> directive manages the addresses of the referrers of (i.e. the
routines that jump to or call) the next instruction.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@refs=[addr1[,addr2...]][:raddr1[,raddr2...]]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">addr1</span></code>, <code class="docutils literal notranslate"><span class="pre">addr2</span></code> etc. are addresses to add to the list of referrers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">raddr1</span></code>, <code class="docutils literal notranslate"><span class="pre">raddr2</span></code> etc. are addresses to remove from the list of
referrers</p></li>
</ul>
<p>This directive can be used to declare one or more additional referrers for an
instruction that would not otherwise be identified by the
<a class="reference internal" href="components.html#instructionutility"><span class="std std-ref">instruction utility</span></a> or
<a class="reference internal" href="components.html#snapshotrefcalc"><span class="std std-ref">snapshot reference calculator</span></a> (e.g. because the
instruction is jumped to indirectly via <code class="docutils literal notranslate"><span class="pre">JP</span> <span class="pre">(HL)</span></code> or <code class="docutils literal notranslate"><span class="pre">RET</span></code>). As a result:</p>
<ul class="simple">
<li><p><a class="reference internal" href="commands.html#sna2skool-py"><span class="std std-ref">sna2skool.py</span></a> will attach an entry point marker (<code class="docutils literal notranslate"><span class="pre">*</span></code>) to the
instruction when reading a control file, and include the additional referrers
in any comment generated for the entry point (when the <code class="docutils literal notranslate"><span class="pre">ListRefs</span></code>
<a class="reference internal" href="commands.html#sna2skool-conf"><span class="std std-ref">configuration parameter</span></a> is <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">2</span></code>)</p></li>
<li><p><cite>snapinfo.py</cite>, when generating a <a class="reference internal" href="commands.html#snapinfo-call-graph"><span class="std std-ref">call graph</span></a>,
will add an edge between a node representing an additional referrer and the
node representing the routine that contains the instruction</p></li>
<li><p>the addresses of the additional referrers become available to the special
<code class="docutils literal notranslate"><span class="pre">EREF</span></code> and <code class="docutils literal notranslate"><span class="pre">REF</span></code> variables of the <a class="reference internal" href="skool-macros.html#foreach"><span class="std std-ref">#FOREACH</span></a> macro</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">&#64;refs</span></code> can also be used to remove one or more referrer addresses that have
been added automatically (because the instruction is jumped to or called
directly). As a result:</p>
<ul class="simple">
<li><p><a class="reference internal" href="commands.html#sna2skool-py"><span class="std std-ref">sna2skool.py</span></a> will remove the referrers from any comment generated for
the entry point (when the <code class="docutils literal notranslate"><span class="pre">ListRefs</span></code>
<a class="reference internal" href="commands.html#sna2skool-conf"><span class="std std-ref">configuration parameter</span></a> is <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">2</span></code>), and
remove any entry point marker (<code class="docutils literal notranslate"><span class="pre">*</span></code>) from the instruction if all the
referrers have been removed</p></li>
<li><p><cite>snapinfo.py</cite>, when generating a <a class="reference internal" href="commands.html#snapinfo-call-graph"><span class="std std-ref">call graph</span></a>,
will not place an edge between a node representing a removed referrer and the
node representing the routine that contains the instruction</p></li>
<li><p>the addresses of the removed referrers will not be available to the special
<code class="docutils literal notranslate"><span class="pre">EREF</span></code> and <code class="docutils literal notranslate"><span class="pre">REF</span></code> variables of the <a class="reference internal" href="skool-macros.html#foreach"><span class="std std-ref">#FOREACH</span></a> macro</p></li>
</ul>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@ 40000 refs=32768:49152
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;refs</span></code> directive (in a control file) declares that the routine at 32768
uses the entry point at 40000, and the routine at 49152 does not.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.2</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rem">
<span id="id17"></span><h3>&#64;rem<a class="headerlink" href="#rem" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;rem</span></code> directive may be used to make an illuminating comment about a
nearby section or other ASM directive in a skool file. The directive is ignored
by the parser.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@rem=COMMENT
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">COMMENT</span></code> is a suitably illuminating comment</p></li>
</ul>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@rem=The next section of data MUST start at 64000
@org=64000
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2.4</p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">=</span></code> is required</p></td>
</tr>
</tbody>
</table>
</section>
<section id="remote">
<span id="id18"></span><h3>&#64;remote<a class="headerlink" href="#remote" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;remote</span></code> directive creates a remote entry in a skool file. A remote
entry enables <code class="docutils literal notranslate"><span class="pre">JR</span></code>, <code class="docutils literal notranslate"><span class="pre">JP</span></code> and <code class="docutils literal notranslate"><span class="pre">CALL</span></code> instructions to be hyperlinked to an
entry defined in another skool file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@remote=code:address[,address2...]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">code</span></code> is the ID of the disassembly defined in the other skool file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">address</span></code> is the address of the remote entry</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">address2</span></code> etc. are addresses of other entry points in the remote entry</p></li>
</ul>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@remote=main:29012,29015
</pre></div>
</div>
<p>This directive, if it appeared in a secondary skool file, would enable
references to the routine at 29012 and its entry point at 29015 in the main
disassembly. It would also enable the <a class="reference internal" href="skool-macros.html#r"><span class="std std-ref">#R</span></a> macro to create a hyperlink to a
remote entry point using the form:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#R29015@main
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>6.3</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="replace">
<span id="id19"></span><h3>&#64;replace<a class="headerlink" href="#replace" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;replace</span></code> directive replaces strings that match a regular expression in
skool file annotations and ref file section names and contents.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@replace=/pattern/repl
</pre></div>
</div>
<p>or:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@replace=/pattern/repl/
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pattern</span></code> is the regular expression</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">repl</span></code> is the replacement string</p></li>
</ul>
<p>(If the second form is used, any text appearing after the terminating <code class="docutils literal notranslate"><span class="pre">/</span></code> is
ignored.)</p>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@replace=/#copy/#CHR(169)
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;replace</span></code> directive replaces all instances of <code class="docutils literal notranslate"><span class="pre">#copy</span></code> with
<code class="docutils literal notranslate"><span class="pre">#CHR(169)</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">/</span></code> appears anywhere in <code class="docutils literal notranslate"><span class="pre">pattern</span></code> or <code class="docutils literal notranslate"><span class="pre">repl</span></code>, then an alternative
separator should be used; for example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@replace=|n/a|not applicable
</pre></div>
</div>
<p>As a convenience for dealing with decimal and hexadecimal numbers, wherever
<code class="docutils literal notranslate"><span class="pre">\i</span></code> appears in <code class="docutils literal notranslate"><span class="pre">pattern</span></code>, it is replaced by a regular expression group
that matches a decimal number or a hexadecimal number preceded by <code class="docutils literal notranslate"><span class="pre">$</span></code>. For
example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@replace=/#udg\i,\i/#UDG(\1,#PEEK\2)
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;replace</span></code> directive would replace <code class="docutils literal notranslate"><span class="pre">#udg$a001,40960</span></code> with
<code class="docutils literal notranslate"><span class="pre">#UDG($a001,#PEEK40960)</span></code>.</p>
<p>Note that string replacements specified by <code class="docutils literal notranslate"><span class="pre">&#64;replace</span></code> directives are made
before skool macros are expanded, and in the order in which the directives
appear in the skool file. For example, if we have:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@replace=/#foo\i/#bar\1
@replace=/#bar\i/#EVAL\1,16
</pre></div>
</div>
<p>then <code class="docutils literal notranslate"><span class="pre">#foo31</span></code> would be replaced by <code class="docutils literal notranslate"><span class="pre">#EVAL31,16</span></code>, but if these directives
were reversed:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@replace=/#bar\i/#EVAL\1,16
@replace=/#foo\i/#bar\1
</pre></div>
</div>
<p>then <code class="docutils literal notranslate"><span class="pre">#foo31</span></code> would be replaced by <code class="docutils literal notranslate"><span class="pre">#bar31</span></code>.</p>
<p>See also the <a class="reference internal" href="skool-macros.html#def"><span class="std std-ref">#DEF</span></a> macro, which is more flexible than <code class="docutils literal notranslate"><span class="pre">&#64;replace</span></code> for
defining new macros.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>6.0</p></td>
<td><p>Replaces strings in ref file section names</p></td>
</tr>
<tr class="row-odd"><td><p>5.1</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rfix">
<span id="id20"></span><h3>&#64;rfix<a class="headerlink" href="#rfix" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> directive replaces, inserts or removes a label, instruction and
comment in <a class="reference internal" href="#rfixmode"><span class="std std-ref">&#64;rfix mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#bfix"><span class="std std-ref">&#64;bfix</span></a> directive.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7.1</p></td>
<td><p>Added support for the <code class="docutils literal notranslate"><span class="pre">+</span></code> marker (to insert an instruction
after the current one)</p></td>
</tr>
<tr class="row-odd"><td><p>7.0</p></td>
<td><p>Added support for specifying the replacement comment over
multiple lines, replacing the label, and inserting, overwriting
and removing instructions</p></td>
</tr>
<tr class="row-even"><td><p>6.4</p></td>
<td><p>Added support for replacing the comment</p></td>
</tr>
<tr class="row-odd"><td><p>5.2</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rfix-block-directives">
<span id="rfixblockdirectives"></span><h3>&#64;rfix block directives<a class="headerlink" href="#rfix-block-directives" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;rfix</span></code> block directives define a block of lines that will be inserted or
removed in <a class="reference internal" href="#rfixmode"><span class="std std-ref">&#64;rfix mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#bfixblockdirectives"><span class="std std-ref">&#64;bfix block directives</span></a>.</p>
</section>
<section id="rom">
<span id="id21"></span><h3>&#64;rom<a class="headerlink" href="#rom" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;rom</span></code> directive inserts a copy of the 48K ZX Spectrum ROM into the
memory snapshot constructed from the contents of the skool file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@rom
</pre></div>
</div>
<p>Some reasons why you might want to do this are:</p>
<ul class="simple">
<li><p>to simulate the execution of ROM code (whether called by game code or
otherwise) with the <a class="reference internal" href="skool-macros.html#sim"><span class="std std-ref">#SIM</span></a> macro</p></li>
<li><p>to create a WAV file of the ROM’s ‘BEEPER’ subroutine in action with the
<a class="reference internal" href="skool-macros.html#audio"><span class="std std-ref">#AUDIO</span></a> macro</p></li>
<li><p>to gain access to the Spectrum character set at 0x3D00 for the purpose of
creating images of text</p></li>
</ul>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">&#64;rom</span></code> directive does nothing if the memory snapshot has
already been converted to 128K by a <a class="reference internal" href="#asm-bank"><span class="std std-ref">&#64;bank</span></a> directive.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.7</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rsub">
<span id="id22"></span><h3>&#64;rsub<a class="headerlink" href="#rsub" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> directive replaces, inserts or removes a label, instruction and
comment in <a class="reference internal" href="#rsubmode"><span class="std std-ref">&#64;rsub mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#rfix"><span class="std std-ref">&#64;rfix</span></a> directive.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7.1</p></td>
<td><p>Added support for the <code class="docutils literal notranslate"><span class="pre">+</span></code> marker (to insert an instruction
after the current one)</p></td>
</tr>
<tr class="row-odd"><td><p>7.0</p></td>
<td><p>Added support for specifying the replacement comment over
multiple lines, replacing the label, and inserting, overwriting
and removing instructions</p></td>
</tr>
<tr class="row-even"><td><p>6.4</p></td>
<td><p>Added support for replacing the comment</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rsub-block-directives">
<span id="rsubblockdirectives"></span><h3>&#64;rsub block directives<a class="headerlink" href="#rsub-block-directives" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;rsub</span></code> block directives define a block of lines that will be inserted or
removed in <a class="reference internal" href="#rsubmode"><span class="std std-ref">&#64;rsub mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#bfixblockdirectives"><span class="std std-ref">&#64;bfix block directives</span></a>.</p>
</section>
<section id="set">
<span id="id23"></span><h3>&#64;set<a class="headerlink" href="#set" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;set</span></code> directive sets a property on the ASM writer.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@set-name=value
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> is the property name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code> is the property value</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">&#64;set</span></code> directives must be placed somewhere after the <a class="reference internal" href="#start"><span class="std std-ref">&#64;start</span></a> directive,
and before the <a class="reference internal" href="#end"><span class="std std-ref">&#64;end</span></a> directive (if there is one).</p>
<p>Recognised property names and their default values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bullet</span></code> - the bullet character(s) to use for list items specified in a
<a class="reference internal" href="skool-macros.html#list"><span class="std std-ref">#LIST</span></a> macro (default: <code class="docutils literal notranslate"><span class="pre">*</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comment-width-min</span></code> - the minimum width of the instruction comment field
(default: <code class="docutils literal notranslate"><span class="pre">10</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">crlf</span></code> - <code class="docutils literal notranslate"><span class="pre">1</span></code> to use CR+LF to terminate lines, or <code class="docutils literal notranslate"><span class="pre">0</span></code> to use the system
default (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">handle-unsupported-macros</span></code> - how to handle an unsupported macro: <code class="docutils literal notranslate"><span class="pre">1</span></code> to
expand it to an empty string, or <code class="docutils literal notranslate"><span class="pre">0</span></code> to exit with an error (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">indent</span></code> - the number of spaces by which to indent instructions (default:
<code class="docutils literal notranslate"><span class="pre">2</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">instruction-width</span></code> - the width of the instruction field (default: <code class="docutils literal notranslate"><span class="pre">23</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label-colons</span></code> - <code class="docutils literal notranslate"><span class="pre">1</span></code> to append a colon to labels, or <code class="docutils literal notranslate"><span class="pre">0</span></code> to leave
labels unadorned (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">line-width</span></code> - the maximum width of each line (default: <code class="docutils literal notranslate"><span class="pre">79</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tab</span></code> - <code class="docutils literal notranslate"><span class="pre">1</span></code> to use a tab character to indent instructions, or <code class="docutils literal notranslate"><span class="pre">0</span></code> to
use spaces (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table-border-horizontal</span></code> - the character to use for the horizontal borders
of a table defined by a <a class="reference internal" href="skool-macros.html#table"><span class="std std-ref">#TABLE</span></a> macro (default: <code class="docutils literal notranslate"><span class="pre">-</span></code>); if two
characters are specified, the first is used for the external borders and the
second is used for the internal borders</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table-border-join</span></code> - the character to use for the horizontal and vertical
border joins of a table defined by a <a class="reference internal" href="skool-macros.html#table"><span class="std std-ref">#TABLE</span></a> macro (default: <code class="docutils literal notranslate"><span class="pre">+</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table-border-vertical</span></code> - the character to use for the vertical borders of
a table defined by a <a class="reference internal" href="skool-macros.html#table"><span class="std std-ref">#TABLE</span></a> macro (default: <code class="docutils literal notranslate"><span class="pre">|</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table-row-separator</span></code> - the character used to separate non-header cells in
adjacent rows of a table defined by a <a class="reference internal" href="skool-macros.html#table"><span class="std std-ref">#TABLE</span></a> macro; by default, such
cells are not separated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warnings</span></code> - <code class="docutils literal notranslate"><span class="pre">1</span></code> to print any warnings that are produced while writing
ASM output (after parsing the skool file), or <code class="docutils literal notranslate"><span class="pre">0</span></code> to suppress them
(default: <code class="docutils literal notranslate"><span class="pre">1</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wrap-column-width-min</span></code> - the minimum width of a wrappable table column
(default: <code class="docutils literal notranslate"><span class="pre">10</span></code>)</p></li>
</ul>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@set-bullet=+
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">&#64;set</span></code> directive sets the bullet character to ‘+’.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>8.1</p></td>
<td><p>Added the <code class="docutils literal notranslate"><span class="pre">table-row-separator</span></code> property</p></td>
</tr>
<tr class="row-odd"><td><p>8.0</p></td>
<td><p>Added the <code class="docutils literal notranslate"><span class="pre">table-border-horizontal</span></code>, <code class="docutils literal notranslate"><span class="pre">table-border-join</span></code>
and <code class="docutils literal notranslate"><span class="pre">table-border-vertical</span></code> properties</p></td>
</tr>
<tr class="row-even"><td><p>3.4</p></td>
<td><p>Added the <code class="docutils literal notranslate"><span class="pre">handle-unsupported-macros</span></code> and
<code class="docutils literal notranslate"><span class="pre">wrap-column-width-min</span></code> properties</p></td>
</tr>
<tr class="row-odd"><td><p>3.3.1</p></td>
<td><p>Added the <code class="docutils literal notranslate"><span class="pre">comment-width-min</span></code>, <code class="docutils literal notranslate"><span class="pre">indent</span></code>,
<code class="docutils literal notranslate"><span class="pre">instruction-width</span></code>, <code class="docutils literal notranslate"><span class="pre">label-colons</span></code>, <code class="docutils literal notranslate"><span class="pre">line-width</span></code> and
<code class="docutils literal notranslate"><span class="pre">warnings</span></code> properties</p></td>
</tr>
<tr class="row-even"><td><p>3.2</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ssub">
<span id="id24"></span><h3>&#64;ssub<a class="headerlink" href="#ssub" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code> directive replaces, inserts or removes a label, instruction and
comment in <a class="reference internal" href="#ssubmode"><span class="std std-ref">&#64;ssub mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#bfix"><span class="std std-ref">&#64;bfix</span></a> directive.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>7.1</p></td>
<td><p>Added support for the <code class="docutils literal notranslate"><span class="pre">+</span></code> marker (to insert an instruction
after the current one)</p></td>
</tr>
<tr class="row-odd"><td><p>7.0</p></td>
<td><p>Added support for specifying the replacement comment over
multiple lines, replacing the label, and inserting, overwriting
and removing instructions</p></td>
</tr>
<tr class="row-even"><td><p>6.4</p></td>
<td><p>Added support for replacing the comment</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ssub-block-directives">
<span id="ssubblockdirectives"></span><h3>&#64;ssub block directives<a class="headerlink" href="#ssub-block-directives" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;ssub</span></code> block directives define a block of lines that will be inserted or
removed in <a class="reference internal" href="#ssubmode"><span class="std std-ref">&#64;ssub mode</span></a>.</p>
<p>The syntax is equivalent to that for the <a class="reference internal" href="#bfixblockdirectives"><span class="std std-ref">&#64;bfix block directives</span></a>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>4.4</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
<section id="start">
<span id="id25"></span><h3>&#64;start<a class="headerlink" href="#start" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;start</span></code> directive indicates where to start parsing the skool file for
the purpose of generating ASM output. Everything before the <code class="docutils literal notranslate"><span class="pre">&#64;start</span></code>
directive is ignored by <a class="reference internal" href="commands.html#skool2asm-py"><span class="std std-ref">skool2asm.py</span></a>.</p>
<p>See also <a class="reference internal" href="#end"><span class="std std-ref">&#64;end</span></a>.</p>
</section>
<section id="writer">
<span id="id26"></span><h3>&#64;writer<a class="headerlink" href="#writer" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;writer</span></code> directive specifies the name of the Python class to use to
generate ASM output. It must be placed somewhere after the <a class="reference internal" href="#start"><span class="std std-ref">&#64;start</span></a>
directive, and before the <a class="reference internal" href="#end"><span class="std std-ref">&#64;end</span></a> directive (if there is one).</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@writer=package.module.classname
</pre></div>
</div>
<p>or:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@writer=/path/to/moduledir:module.classname
</pre></div>
</div>
<p>The second of these forms may be used to specify a class in a module that is
outside the module search path (e.g. a standalone module that is not part of
an installed package).</p>
<p>The default ASM writer class is skoolkit.skoolasm.AsmWriter. For information on
how to create your own Python class for generating ASM output, see the
documentation on <a class="reference internal" href="extending.html#extendingskoolkit"><span class="std std-ref">extending SkoolKit</span></a>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3.3.1</p></td>
<td><p>Added support for specifying a module outside the module search
path</p></td>
</tr>
<tr class="row-odd"><td><p>3.1</p></td>
<td><p>New</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">ASM modes and directives</a><ul>
<li><a class="reference internal" href="#substitution-modes">Substitution modes</a><ul>
<li><a class="reference internal" href="#isub-mode">&#64;isub mode</a></li>
<li><a class="reference internal" href="#ssub-mode">&#64;ssub mode</a></li>
<li><a class="reference internal" href="#rsub-mode">&#64;rsub mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bugfix-modes">Bugfix modes</a><ul>
<li><a class="reference internal" href="#ofix-mode">&#64;ofix mode</a></li>
<li><a class="reference internal" href="#bfix-mode">&#64;bfix mode</a></li>
<li><a class="reference internal" href="#rfix-mode">&#64;rfix mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#asm-directives">ASM directives</a><ul>
<li><a class="reference internal" href="#assemble">&#64;assemble</a></li>
<li><a class="reference internal" href="#bank">&#64;bank</a></li>
<li><a class="reference internal" href="#bfix">&#64;bfix</a></li>
<li><a class="reference internal" href="#bfix-block-directives">&#64;bfix block directives</a></li>
<li><a class="reference internal" href="#defb">&#64;defb</a></li>
<li><a class="reference internal" href="#defs">&#64;defs</a></li>
<li><a class="reference internal" href="#defw">&#64;defw</a></li>
<li><a class="reference internal" href="#end">&#64;end</a></li>
<li><a class="reference internal" href="#equ">&#64;equ</a></li>
<li><a class="reference internal" href="#expand">&#64;expand</a></li>
<li><a class="reference internal" href="#if">&#64;if</a></li>
<li><a class="reference internal" href="#ignoreua">&#64;ignoreua</a></li>
<li><a class="reference internal" href="#isub">&#64;isub</a></li>
<li><a class="reference internal" href="#isub-block-directives">&#64;isub block directives</a></li>
<li><a class="reference internal" href="#keep">&#64;keep</a></li>
<li><a class="reference internal" href="#label">&#64;label</a></li>
<li><a class="reference internal" href="#nowarn">&#64;nowarn</a></li>
<li><a class="reference internal" href="#ofix">&#64;ofix</a></li>
<li><a class="reference internal" href="#ofix-block-directives">&#64;ofix block directives</a></li>
<li><a class="reference internal" href="#org">&#64;org</a></li>
<li><a class="reference internal" href="#refs">&#64;refs</a></li>
<li><a class="reference internal" href="#rem">&#64;rem</a></li>
<li><a class="reference internal" href="#remote">&#64;remote</a></li>
<li><a class="reference internal" href="#replace">&#64;replace</a></li>
<li><a class="reference internal" href="#rfix">&#64;rfix</a></li>
<li><a class="reference internal" href="#rfix-block-directives">&#64;rfix block directives</a></li>
<li><a class="reference internal" href="#rom">&#64;rom</a></li>
<li><a class="reference internal" href="#rsub">&#64;rsub</a></li>
<li><a class="reference internal" href="#rsub-block-directives">&#64;rsub block directives</a></li>
<li><a class="reference internal" href="#set">&#64;set</a></li>
<li><a class="reference internal" href="#ssub">&#64;ssub</a></li>
<li><a class="reference internal" href="#ssub-block-directives">&#64;ssub block directives</a></li>
<li><a class="reference internal" href="#start">&#64;start</a></li>
<li><a class="reference internal" href="#writer">&#64;writer</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="ref-files.html"
                          title="previous chapter">Ref files</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="asm-templates.html"
                          title="next chapter">ASM templates</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/asm.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="asm-templates.html" title="ASM templates"
             >next</a> |</li>
        <li class="right" >
          <a href="ref-files.html" title="Ref files"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SkoolKit 9.1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ASM modes and directives</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2024, Richard Dymond.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>