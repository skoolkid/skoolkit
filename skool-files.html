<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Skool files &mdash; SkoolKit 5.0 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="SkoolKit 5.0 documentation" href="index.html" />
    <link rel="next" title="Skool file templates" href="skool-file-templates.html" />
    <link rel="prev" title="Control files" href="control-files.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="skool-file-templates.html" title="Skool file templates"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="control-files.html" title="Control files"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">SkoolKit 5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Skool files</a><ul>
<li><a class="reference internal" href="#skool-file-format">Skool file format</a><ul>
<li><a class="reference internal" href="#entry-header-format">Entry header format</a></li>
<li><a class="reference internal" href="#entry-line-format">Entry line format</a></li>
</ul>
</li>
<li><a class="reference internal" href="#asm-directives">ASM directives</a></li>
<li><a class="reference internal" href="#escaping-characters">Escaping characters</a></li>
<li><a class="reference internal" href="#braces-in-comments">Braces in comments</a></li>
<li><a class="reference internal" href="#data-definition-entries">Data definition entries</a></li>
<li><a class="reference internal" href="#remote-entries">Remote entries</a></li>
<li><a class="reference internal" href="#revision-history">Revision history</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="control-files.html"
                        title="previous chapter">Control files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="skool-file-templates.html"
                        title="next chapter">Skool file templates</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/skool-files.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="skool-files">
<span id="skoolfiles"></span><h1>Skool files<a class="headerlink" href="#skool-files" title="Permalink to this headline">¶</a></h1>
<p>A <cite>skool</cite> file contains the list of Z80 instructions that make up the routines
and data blocks of the program being disassembled, with accompanying comments
(if any).</p>
<div class="section" id="skool-file-format">
<span id="skoolfileformat"></span><h2>Skool file format<a class="headerlink" href="#skool-file-format" title="Permalink to this headline">¶</a></h2>
<p>A <cite>skool</cite> file must be in a certain format to ensure that it is processed
correctly by <a class="reference internal" href="commands.html#skool2html-py"><em>skool2html.py</em></a>, <a class="reference internal" href="commands.html#skool2asm-py"><em>skool2asm.py</em></a>, <a class="reference internal" href="commands.html#skool2ctl-py"><em>skool2ctl.py</em></a> and
<a class="reference internal" href="commands.html#skool2sft-py"><em>skool2sft.py</em></a>. The rules are as follows:</p>
<ul class="simple">
<li>entries (an &#8216;entry&#8217; being a routine or data block) must be separated by
blank lines, and an entry must not contain any blank lines</li>
<li>an entry header is a sequence of comment lines broken into four sections;
see <a class="reference internal" href="#entryheaderformat"><em>Entry header format</em></a></li>
<li>each line in an entry may start with one of the following characters:
<tt class="docutils literal"><span class="pre">;*</span> <span class="pre">&#64;bcdgirstuw</span></tt>; see <a class="reference internal" href="#entrylineformat"><em>Entry line format</em></a></li>
<li>tables (grids) have their own markup syntax; see <a class="reference internal" href="skool-macros.html#table"><em>#TABLE</em></a> for details</li>
</ul>
<div class="section" id="entry-header-format">
<span id="entryheaderformat"></span><h3>Entry header format<a class="headerlink" href="#entry-header-format" title="Permalink to this headline">¶</a></h3>
<p>An entry header is a sequence of comment lines broken into four sections:</p>
<ul class="simple">
<li>entry title</li>
<li>entry description (optional)</li>
<li>registers (optional)</li>
<li>start comment (optional)</li>
</ul>
<p>The sections are separated by an empty comment line, and paragraphs within
the entry description and start comment must be separated by a comment line
containing a dot (<tt class="docutils literal"><span class="pre">.</span></tt>) on its own. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; This is the entry title
;
; This is the first paragraph of the entry description.
; .
; This is the second paragraph of the entry description.
;
; A An important parameter
; B Another important parameter
;
; This is the start comment above the first instruction in the entry.
</pre></div>
</div>
<p>If a start comment is required but a register section is not, either append the
start comment to the entry description, or specify a blank register section by
using a dot (<tt class="docutils literal"><span class="pre">.</span></tt>) thus:</p>
<div class="highlight-none"><div class="highlight"><pre>; This entry has a start comment but no register section
;
; This is the entry description.
;
; .
;
; This is the start comment above the first instruction in the entry.
</pre></div>
</div>
<p>Likewise, if a register section is required but an entry description is not, a
blank entry description may be specified by using a dot (<tt class="docutils literal"><span class="pre">.</span></tt>) thus:</p>
<div class="highlight-none"><div class="highlight"><pre>; This entry has a register section but no description
;
; .
;
; A An important parameter
; B Another important parameter
</pre></div>
</div>
<p>Registers may be listed as shown above, or with colon-terminated prefixes
(such as &#8216;Input:&#8217; and &#8216;Output:&#8217;, or simply &#8216;I:&#8217; and &#8216;O:&#8217;) to distinguish
input values from output values:</p>
<div class="highlight-none"><div class="highlight"><pre>;  Input:A An important parameter
;        B Another important parameter
; Output:C The result
</pre></div>
</div>
<p>In the HTML version of the disassembly, input values and output values are
shown in separate tables. If a register&#8217;s prefix begins with the letter &#8216;O&#8217;,
it is regarded as an output value; if it begins with any other letter, it is
regarded as an input value. If a register has no prefix, it will be placed in
the same table as the previous register; if there is no previous register, it
will be placed in the table of input values.</p>
<p>If a register description is very long, it may be split over two or more lines
by starting the second and subsequent lines with a dot (<tt class="docutils literal"><span class="pre">.</span></tt>) thus:</p>
<div class="highlight-none"><div class="highlight"><pre>; HL The description for this register is quite long, so it is split over two
; .  lines for improved readability
</pre></div>
</div>
</div>
<div class="section" id="entry-line-format">
<span id="entrylineformat"></span><h3>Entry line format<a class="headerlink" href="#entry-line-format" title="Permalink to this headline">¶</a></h3>
<p>Each line in an entry may start with one of <tt class="docutils literal"><span class="pre">;*</span> <span class="pre">&#64;bcdgirstuw</span></tt>, where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">;</span></tt> begins a comment line</li>
<li><tt class="docutils literal"><span class="pre">*</span></tt> denotes an entry point in a routine</li>
<li><tt class="docutils literal"><span class="pre">&#64;</span></tt> begins an <a class="reference internal" href="#asm"><em>ASM directive</em></a></li>
<li><tt class="docutils literal"><span class="pre">b</span></tt> denotes the first instruction in a data block</li>
<li><tt class="docutils literal"><span class="pre">c</span></tt> denotes the first instruction in a code block (routine)</li>
<li><tt class="docutils literal"><span class="pre">d</span></tt> denotes the first instruction in a
<a class="reference internal" href="#dentry"><em>data definition entry</em></a></li>
<li><tt class="docutils literal"><span class="pre">g</span></tt> denotes the first instruction in a game status buffer entry</li>
<li><tt class="docutils literal"><span class="pre">i</span></tt> denotes an ignored entry</li>
<li><tt class="docutils literal"><span class="pre">r</span></tt> denotes the first instruction in a <a class="reference internal" href="#rentry"><em>remote entry</em></a></li>
<li><tt class="docutils literal"><span class="pre">s</span></tt> denotes the first instruction in a data block containing bytes that
are all the same value (typically unused zeroes)</li>
<li><tt class="docutils literal"><span class="pre">t</span></tt> denotes the first instruction in a data block that contains text</li>
<li><tt class="docutils literal"><span class="pre">u</span></tt> denotes the first instruction in an unused code or data block</li>
<li><tt class="docutils literal"><span class="pre">w</span></tt> denotes the first instruction in a data block that contains two-byte
values (words)</li>
<li>a space begins a line that does not require any of the markers listed above</li>
</ul>
<p>The format of a line containing an instruction is:</p>
<div class="highlight-none"><div class="highlight"><pre>C##### INSTRUCTION[ ; comment]
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">C</span></tt> is one of the characters listed above: <tt class="docutils literal"><span class="pre">*</span> <span class="pre">bcdgirstuw</span></tt></li>
<li><tt class="docutils literal"><span class="pre">#####</span></tt> is an address (e.g. <tt class="docutils literal"><span class="pre">24576</span></tt>, or <tt class="docutils literal"><span class="pre">$6000</span></tt> if you prefer
hexadecimal notation)</li>
<li><tt class="docutils literal"><span class="pre">INSTRUCTION</span></tt> is an instruction (e.g. <tt class="docutils literal"><span class="pre">LD</span> <span class="pre">A,(HL)</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">comment</span></tt> is a comment (which may be blank)</li>
</ul>
<p>The comment for a single instruction may span multiple lines thus:</p>
<div class="highlight-none"><div class="highlight"><pre>c24296 CALL 57935    ; This comment is too long to fit on a single line, so
                     ; we use two lines
</pre></div>
</div>
<p>A comment may also be associated with more than one instruction by the use of
braces (<tt class="docutils literal"><span class="pre">{</span></tt> and <tt class="docutils literal"><span class="pre">}</span></tt>) to indicate the start and end points, thus:</p>
<div class="highlight-none"><div class="highlight"><pre>*24372 SUB D         ; {This comment applies to the two instructions at
 24373 JR NZ,24378   ; 24372 and 24373}
</pre></div>
</div>
<p>The opening and closing braces are removed before the comment is rendered in
ASM or HTML mode. (See <a class="reference internal" href="#bracesincomments"><em>Braces in comments</em></a>.)</p>
<p>Comments may appear between instructions, or after the last instruction in an
entry; paragraphs in such comments must be separated by a comment line
containing a dot (<tt class="docutils literal"><span class="pre">.</span></tt>) on its own. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>*28975 JR 28902
; This is a mid-block comment between two instructions.
; .
; This is the second paragraph of the comment.
 28977 XOR A
</pre></div>
</div>
<p>Lines that start with <tt class="docutils literal"><span class="pre">*</span></tt> will have their addresses shown in bold in the
HTML version of the disassembly (generated by <a class="reference internal" href="commands.html#skool2html-py"><em>skool2html.py</em></a>), and will
have labels generated for them in the ASM version (generated by
<a class="reference internal" href="commands.html#skool2asm-py"><em>skool2asm.py</em></a>).</p>
</div>
</div>
<div class="section" id="asm-directives">
<span id="asm"></span><h2>ASM directives<a class="headerlink" href="#asm-directives" title="Permalink to this headline">¶</a></h2>
<p>To write an ASM directive in a skool file, start a line with <tt class="docutils literal"><span class="pre">&#64;</span></tt>; for
example:</p>
<div class="highlight-none"><div class="highlight"><pre>; Start the game
@label=START
c24576 XOR A
</pre></div>
</div>
<p>See <a class="reference internal" href="asm.html#asmmodesanddirectives"><em>ASM modes and directives</em></a> for more details.</p>
</div>
<div class="section" id="escaping-characters">
<h2>Escaping characters<a class="headerlink" href="#escaping-characters" title="Permalink to this headline">¶</a></h2>
<p>Backslash (<tt class="docutils literal"><span class="pre">\</span></tt>) and double quote (<tt class="docutils literal"><span class="pre">&quot;</span></tt>) characters in string and character
operands must be escaped by preceding them with a backslash. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>c32768 LD A,&quot;\&quot;&quot;     ; LD A,34
 32770 LD B,&quot;\\&quot;     ; LD B,92
</pre></div>
</div>
<p>This ensures that SkoolKit or an assembler can parse such operands correctly.</p>
</div>
<div class="section" id="braces-in-comments">
<span id="bracesincomments"></span><h2>Braces in comments<a class="headerlink" href="#braces-in-comments" title="Permalink to this headline">¶</a></h2>
<p>As noted above, opening and closing braces (<tt class="docutils literal"><span class="pre">{</span></tt>, <tt class="docutils literal"><span class="pre">}</span></tt>) are used to mark the
start and end points of an instruction-level comment that is associated with
more than one instruction, and the braces are removed before the comment is
rendered. This means that if the comment requires an opening or closing brace
<cite>when rendered</cite>, some care must be taken to get the syntax correct.</p>
<p>The rules regarding an instruction-level comment that starts with an opening
brace are as follows:</p>
<ul class="simple">
<li>The comment terminates on the line where the total number of closing braces
in the comment becomes equal to or greater than the total number of opening
braces</li>
<li>Adjacent opening braces at the start of the comment are removed before
rendering</li>
<li>Adjacent closing braces at the end of the comment are removed before
rendering</li>
</ul>
<p>By these rules, it is possible to craft an instruction-level comment that
contains matched or unmatched opening and closing braces when rendered.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>b50000 DEFB 0  ; {{This comment (which spans two instructions) has an
 50001 DEFB 0  ; unmatched closing brace} }
</pre></div>
</div>
<p>will render in ASM mode as:</p>
<div class="highlight-none"><div class="highlight"><pre>DEFB 0                  ; This comment (which spans two instructions) has an
DEFB 0                  ; unmatched closing brace}
</pre></div>
</div>
<p>And:</p>
<div class="highlight-none"><div class="highlight"><pre>b50002 DEFB 0  ; { {{Matched opening and closing braces}} }
</pre></div>
</div>
<p>will render as:</p>
<div class="highlight-none"><div class="highlight"><pre>DEFB 0                  ; {{Matched opening and closing braces}}
</pre></div>
</div>
<p>Finally:</p>
<div class="highlight-none"><div class="highlight"><pre>b50003 DEFB 0  ; { {Unmatched opening brace}}
</pre></div>
</div>
<p>will render as:</p>
<div class="highlight-none"><div class="highlight"><pre>DEFB 0                  ; {Unmatched opening brace
</pre></div>
</div>
</div>
<div class="section" id="data-definition-entries">
<span id="dentry"></span><h2>Data definition entries<a class="headerlink" href="#data-definition-entries" title="Permalink to this headline">¶</a></h2>
<p>If the first instruction line in an entry starts with <tt class="docutils literal"><span class="pre">d</span></tt>, the entry is
regarded as a data definition entry. Such entries do not appear in the memory
map generated by <cite>skool2html.py</cite>, but may contain <tt class="docutils literal"><span class="pre">DEFB</span></tt>, <tt class="docutils literal"><span class="pre">DEFM</span></tt>, <tt class="docutils literal"><span class="pre">DEFS</span></tt>
and <tt class="docutils literal"><span class="pre">DEFW</span></tt> statements that will be used to insert data into the memory
snapshot.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; The eight bytes of code in this routine are also used as UDG data.
; .
; #HTML(#UDG44919)
c44919 LD DE,46572   ;
 44922 CP 200        ;
 44924 JP 45429      ;

d44919 DEFB 17,236,181,254,200,195,117,177
</pre></div>
</div>
<p>If this data definition entry were not present, the memory snapshot would
contain zeroes at addresses 44919-44926, and the image created by the <tt class="docutils literal"><span class="pre">#UDG</span></tt>
macro would be blank. The reason for this is that by default, the skool file
parser does not convert assembly language instructions into byte values.
However, this behaviour can be changed by using the <a class="reference internal" href="asm.html#assemble"><em>&#64;assemble</em></a> directive.</p>
</div>
<div class="section" id="remote-entries">
<span id="rentry"></span><h2>Remote entries<a class="headerlink" href="#remote-entries" title="Permalink to this headline">¶</a></h2>
<p>If the first instruction line in an entry starts with <tt class="docutils literal"><span class="pre">r</span></tt>, the entry is
regarded as a remote entry. Such entries do not appear in the memory map
generated by <cite>skool2html.py</cite>, but they enable <tt class="docutils literal"><span class="pre">JR</span></tt>, <tt class="docutils literal"><span class="pre">JP</span></tt> and <tt class="docutils literal"><span class="pre">CALL</span></tt>
instructions to be hyperlinked to entries defined in other <cite>skool</cite> files.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>r26880 main
</pre></div>
</div>
<p>This entry, if it were present in a secondary <cite>skool</cite> file, would enable any
<tt class="docutils literal"><span class="pre">JR</span></tt>, <tt class="docutils literal"><span class="pre">JP</span></tt> and <tt class="docutils literal"><span class="pre">CALL</span></tt> instruction with 26880 as the operand to be
hyperlinked to that routine in the main disassembly (the entry for which should
be defined in the main <cite>skool</cite> file).</p>
<p>If the desired target of the hyperlink is an entry point within a routine that
is defined in another <cite>skool</cite> file (as opposed to the address of the routine
itself), both the routine address and the entry point address should be
declared in the remote entry. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>r29012 main
 29015
</pre></div>
</div>
<p>This enables hyperlinks to 29015 in the main disassembly, which is an entry
point in the routine at 29012. It also enables the <a class="reference internal" href="skool-macros.html#r"><em>#R</em></a> macro to create
hyperlinks to remote entry points using the short form:</p>
<div class="highlight-none"><div class="highlight"><pre>#R29015@main
</pre></div>
</div>
<p>instead of the longer form (which would be required if the remote entry were
not defined):</p>
<div class="highlight-none"><div class="highlight"><pre>#R29012@main#29015(29015)
</pre></div>
</div>
</div>
<div class="section" id="revision-history">
<h2>Revision history<a class="headerlink" href="#revision-history" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>4.3</td>
<td>Added support for the start comment in entry headers; an ASM
directive can be declared by starting a line with <tt class="docutils literal"><span class="pre">&#64;</span></tt></td>
</tr>
<tr class="row-odd"><td>4.2</td>
<td>Added support for splitting register descriptions over multiple
lines</td>
</tr>
<tr class="row-even"><td>3.7</td>
<td>Added support for binary numbers; added the <tt class="docutils literal"><span class="pre">s</span></tt> block type</td>
</tr>
<tr class="row-odd"><td>3.1.2</td>
<td>Added support for &#8216;Input&#8217; and &#8216;Output&#8217; prefixes in register
sections</td>
</tr>
<tr class="row-even"><td>2.4</td>
<td>Added the ability to separate paragraphs and specify a blank
entry description by using a dot (<tt class="docutils literal"><span class="pre">.</span></tt>) on a line of its own</td>
</tr>
<tr class="row-odd"><td>2.1</td>
<td>Added support for hexadecimal numbers</td>
</tr>
<tr class="row-even"><td>2.0</td>
<td>Added support for data definition entries and remote entries</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="skool-file-templates.html" title="Skool file templates"
             >next</a> |</li>
        <li class="right" >
          <a href="control-files.html" title="Control files"
             >previous</a> |</li>
        <li><a href="index.html">SkoolKit 5.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Richard Dymond.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>